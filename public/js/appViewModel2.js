// Generated by CoffeeScript 1.4.0
(function() {
  var AppViewModel, _ref,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  if ((_ref = window.nicetohave) == null) {
    window.nicetohave = {};
  }

  AppViewModel = (function() {

    function AppViewModel() {
      this.saveEdits = __bind(this.saveEdits, this);

      var _this = this;
      this.privilege = new nicetohave.Privilege(Trello);
      this.cards = ko.observableArray([new nicetohave.Card("510557f3e002eb8d56002e04", this.privilege), new nicetohave.Card("5105af6108fa2a6e21000dc5", this.privilege)]);
      this._cachedCategorisations = {};
      this.categorisations = ko.computed(function() {
        return _this.cards().map(function(card) {
          if (_this._cachedCategorisations[card.id()]) {
            return _this._cachedCategorisations[card.id()];
          } else {
            _this._cachedCategorisations[card.id()] = new nicetohave.Categorisation(card);
            return _this._cachedCategorisations[card.id()];
          }
        });
      });
      this.haveEdits = ko.computed(function() {
        return _this.categorisations().filter(function(c) {
          return c.hasEdits();
        });
      });
      this.hasEdits = ko.computed(function() {
        return _this.haveEdits().length > 0;
      });
    }

    AppViewModel.prototype.saveEdits = function() {
      return this.haveEdits().forEach(function(h) {
        return h.saveEdits();
      });
    };

    return AppViewModel;

  })();

  window.nicetohave.AppViewModel = AppViewModel;

}).call(this);
