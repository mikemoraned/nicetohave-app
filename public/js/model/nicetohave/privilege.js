// Generated by CoffeeScript 1.4.0
(function() {
  var Privilege, _ref;

  if ((_ref = window.nicetohave) == null) {
    window.nicetohave = {};
  }

  Privilege = (function() {

    function Privilege(trello) {
      this.trello = trello;
      this.level = ko.observable(nicetohave.PrivilegeLevel.NONE);
    }

    Privilege.prototype.using = function(expectedLevel, success) {
      if (this.level().satisfies(expectedLevel)) {
        return success(this.trello);
      } else {
        console.log("Raising level to");
        console.dir(expectedLevel);
        return this.raiseTo(expectedLevel, success);
      }
    };

    Privilege.prototype.raiseTo = function(level, success) {
      var _this = this;
      this.trello.deauthorize();
      return this.trello.authorize({
        type: "popup",
        name: "Nice to have",
        success: function() {
          _this.level(level);
          return success(_this.trello);
        },
        error: function(m) {
          return console.log("Error: " + m);
        },
        scope: level.trelloScope
      });
    };

    return Privilege;

  })();

  window.nicetohave.Privilege = Privilege;

}).call(this);
